Code taken pretty much exactly from Marco Salvi's ESM_SHADERX6_DVD and modified to work with Ogre

see http://pixelstoomany.wordpress.com/category/shadows/exponential-shadow-maps/

(download link to the FXComposer script)